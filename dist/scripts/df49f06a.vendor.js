!function(){"use strict";function a(){this.impl=null,this.isPlaying=!1,this.samplerate=44100,this.channels=2,this.cellsize=128,this.streammsec=20,this.streamsize=0,this.generator=null}var b=null,c=function(){return"undefined"!=typeof window?window.webkitAudioContext||window.AudioContext:void 0}();b=void 0!==c?function(a){var b,d,e=new c;this.maxSamplerate=e.sampleRate,this.defaultSamplerate=e.sampleRate,this.env="webkit";var f=navigator.userAgent;f.match(/linux/i)?a.streammsec*=8:f.match(/win(dows)?\s*(nt 5\.1|xp)/i)&&(a.streammsec*=4),this.play=function(){var c,f,g,h=a.getAdjustSamples(e.sampleRate),i=a.streamsize;a.samplerate===e.sampleRate?c=function(b){var c=b.outputBuffer;a.process(),c.getChannelData(0).set(a.strmL),c.getChannelData(1).set(a.strmR)}:2*a.samplerate===e.sampleRate?c=function(b){var c,d,e=a.strmL,f=a.strmR,g=b.outputBuffer,h=g.getChannelData(0),i=g.getChannelData(1),j=g.length;for(a.process(),c=d=0;j>c;c+=2,++d)h[c]=h[c+1]=e[d],i[c]=i[c+1]=f[d]}:(f=i,g=a.samplerate/e.sampleRate,c=function(b){var c,d=a.strmL,e=a.strmR,h=b.outputBuffer,j=h.getChannelData(0),k=h.getChannelData(1),l=h.length;for(c=0;l>c;++c)f>=i&&(a.process(),f-=i),j[c]=d[0|f],k[c]=e[0|f],f+=g}),b=e.createBufferSource(),d=e.createJavaScriptNode(h,2,a.channels),d.onaudioprocess=c,b.noteOn(0),b.connect(d),d.connect(e.destination)},this.pause=function(){b.disconnect(),d.disconnect()}}:"function"==typeof Audio&&"function"==typeof(new Audio).mozSetup?function(a){var b=function(){var a="var t=0;onmessage=function(e){if(t)t=clearInterval(t),0;if(typeof e.data=='number'&&e.data>0)t=setInterval(function(){postMessage(0);},e.data);};",b=new Blob([a],{type:"text/javascript"}),c=window.URL.createObjectURL(b);return new Worker(c)}();this.maxSamplerate=48e3,this.defaultSamplerate=44100,this.env="moz",this.play=function(){var c=new Audio,d=new Float32Array(a.streamsize*a.channels),e=a.streammsec,f=0,g=1e3*(a.streamsize/a.samplerate),h=Date.now(),i=function(){if(!(f>Date.now()-h)){var b=a.strmL,e=a.strmR,i=d.length,j=b.length;for(a.process();j--;)d[--i]=e[j],d[--i]=b[j];c.mozWriteAudio(d),f+=g}};c.mozSetup(a.channels,a.samplerate),b.onmessage=i,b.postMessage(e)},this.pause=function(){b.postMessage(0)}}:function(){this.maxSamplerate=48e3,this.defaultSamplerate=8e3,this.env="nop",this.play=function(){},this.pause=function(){}};var d=[8e3,11025,12e3,16e3,22050,24e3,32e3,44100,48e3],e=[32,64,128,256];a.prototype.bind=function(a,b){if("function"==typeof a){var c=new a(this,b);"function"==typeof c.play&&"function"==typeof c.pause&&(this.impl=c,this.impl.defaultSamplerate&&(this.samplerate=this.impl.defaultSamplerate))}return this},a.prototype.setup=function(a){if("object"==typeof a)-1!==d.indexOf(a.samplerate)&&(this.samplerate=a.samplerate<=this.impl.maxSamplerate?a.samplerate:this.impl.maxSamplerate),-1!==e.indexOf(a.cellsize)&&(this.cellsize=a.cellsize);else if("string"==typeof a)switch(a){case"mobile":this.samplerate=22050,this.cellsize=128;break;case"high-res":this.cellsize=32;break;case"low-res":this.cellsize=256}return this},a.prototype.getAdjustSamples=function(a){var b,c;return a=a||this.samplerate,b=this.streammsec/1e3*a,c=Math.ceil(Math.log(b)*Math.LOG2E),c=8>c?8:c>14?14:c,1<<c},a.prototype.play=function(a){return this.isPlaying||"object"!=typeof a?this:(this.isPlaying=!0,this.generator=a,this.streamsize=this.getAdjustSamples(),this.strmL=new Float32Array(this.streamsize),this.strmR=new Float32Array(this.streamsize),this.cellL=new Float32Array(this.cellsize),this.cellR=new Float32Array(this.cellsize),this.impl.play(),this)},a.prototype.pause=function(){return this.isPlaying&&(this.isPlaying=!1,this.impl.pause()),this},a.prototype.process=function(){for(var a,b,c=this.cellL,d=this.cellR,e=this.strmL,f=this.strmR,g=this.generator,h=c.length,i=0,j=this.streamsize/this.cellsize;j--;)for(g.process(c,d),a=0;h>a;++a,++i)b=c[a],e[i]=-1>b?-1:b>1?1:b,b=d[a],f[i]=-1>b?-1:b>1?1:b};var f=(new a).bind(b),g={setup:function(a){return f.setup(a),this},bind:function(a,b){return f.bind(a,b),this},play:function(a){return f.play(a),this},pause:function(){return f.pause(),this}};Object.defineProperties(g,{env:{get:function(){return f.impl.env}},samplerate:{get:function(){return f.samplerate}},channels:{get:function(){return f.channels}},cellsize:{get:function(){return f.cellsize}},isPlaying:{get:function(){return f.isPlaying}}}),"undefined"!=typeof module&&module.exports?module.exports=global.pico=g:"undefined"!=typeof window&&(void 0===window.Float32Array&&(window.Float32Array=function(a){var b;if(Array.isArray(a))b=a.slice();else if("number"==typeof a){b=Array(a);for(var c=0;a>c;++c)b[c]=0}else b=[];return b.set=function(a,b){void 0===b&&(b=0);var c,d=Math.min(this.length-b,a.length);for(c=0;d>c;++c)this[b+c]=a[c]},b.subarray=function(a,b){return void 0===b&&(b=this.length),this.slice(a,b)},b}),g.noConflict=function(){var a=window.pico;return function(){return window.pico===g&&(window.pico=a),g}}(),window.pico=g),function(){function a(a){try{return b.plugins&&b.mimeTypes&&b.mimeTypes.length?b.plugins["Shockwave Flash"].description.match(/([0-9]+)/)[a]:new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").match(/([0-9]+)/)[a]}catch(c){return-1}}if("undefined"!=typeof window&&"nop"===window.pico.env){var b=navigator;if(!(10>a(0))){var c,d="PicoFlashPlayerDiv",e=function(){var a=document.getElementsByTagName("script");if(a&&a.length)for(var b,c=0,d=a.length;d>c;++c)if(b=/^(.*\/)pico(?:\.dev)?\.js$/i.exec(a[c].src))return b[1]+"pico.swf"}();window.picojs_flashfallback_init=function(){function a(a){var b=0;this.maxSamplerate=44100,this.defaultSamplerate=44100,this.env="flash",this.play=function(){var d,f=Array(a.streamsize*a.channels),g=a.streammsec,h=0,i=1e3*(a.streamsize/a.samplerate),j=Date.now();d=function(){if(!(h>Date.now()-j)){var b=a.strmL,d=a.strmR,e=f.length,g=b.length;for(a.process();g--;)f[--e]=0|32768*d[g],f[--e]=0|32768*b[g];c.writeAudio(f.join(" ")),h+=i}},c.setup?(c.setup(a.channels,a.samplerate),b=setInterval(d,g)):console.warn("Cannot find "+e)},this.pause=function(){0!==b&&(c.cancel(),clearInterval(b),b=0)}}f.bind(a),delete window.picojs_flashfallback_init};var g,h,i=e,j=i+"?"+ +new Date,k="PicoFlashPlayer",l=document.createElement("div");l.id=d,l.style.display="inline",l.width=l.height=1,b.plugins&&b.mimeTypes&&b.mimeTypes.length?(g=document.createElement("object"),g.id=k,g.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",g.width=g.height=1,g.setAttribute("data",j),g.setAttribute("type","application/x-shockwave-flash"),h=document.createElement("param"),h.setAttribute("name","allowScriptAccess"),h.setAttribute("value","always"),g.appendChild(h),l.appendChild(g)):l.innerHTML='<object id="'+k+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1" height="1"><param name="movie" value="'+j+'" /><param name="bgcolor" value="#FFFFFF" /><param name="quality" value="high" /><param name="allowScriptAccess" value="always" /></object>',window.addEventListener("load",function(){document.body.appendChild(l),c=document[k]})}}}()}(),this.audioLib=function a(b,c,d,e){function f(a){f.list.push(a)}function g(a){var b=new M(a);return b.subarray=b.subarray||b.slice,b}function h(a,b,c,d){O?O(a,b,{get:function(){return c},enumerable:!!d}):a[b]=c}function i(a){var b,c,d=arguments,e=d.length;for(b=1;e>b;b++)for(c in d[b])d[b].hasOwnProperty(c)&&(a[c]=d[b][c]);return a}function j(a,b,c){var d;for(d in a)(a.hasOwnProperty(d)||c)&&b.call(a,a[d],d);return a}function k(a,b,c){var d,f;if(!c)if(c=[],d=/^\s*function\s*\w*\s*\(([^\)]+)/.exec(b))d[1].replace(/[a-z$_0-9]+/gi,function(a){c.push(a)});else for(d=0;d<b.length;d++)c[d]=e(d+2).join("_");return f=Function("var __q;return function "+a+"("+c.join()+"){var i; if(__q){__q=!__q}else if(this instanceof "+a+")this.__CLASSCONSTRUCTOR.apply(this,arguments);else{__q=!__q;i=new "+a+";i.__CLASSCONSTRUCTOR.apply(i,arguments);return i}};")(),f.prototype=b.prototype,f.prototype.__CLASSCONSTRUCTOR=b,i(f,b),f}function l(a,b,c,d){this.parameter=a,this.automation=b,this.amount=isNaN(c)?this.amount:c,this.setType(d)}function m(a,b,c,d,e){if(!a.automation)switch(a.automation=[],a.type){case"generator":a.append=m.generatorAppend;break;case"effect":a.append=m.effectAppend;break;case"buffereffect":a.append=m.bufferEffectAppend}return c=new l(b,c,d,e),a.automation.push(c),c}function n(a,b,c){function d(){a.apply(this,c)}for(this.channelCount=isNaN(b)?this.channelCount:b,this.effects=[],d.prototype=a.prototype;b--;)this.effects.push(new d)}function o(a,b){var c=a[0].toUpperCase()+a.substr(1).toLowerCase();return o[a]=b,b.decode&&(N.Sampler.prototype["load"+c]=function(b){this.load.apply(this,[o[a].decode(b)].concat([].slice.call(arguments,1)))}),b.encode&&(N.AudioDevice.Recording.prototype["to"+c]=function(b){return o[a].encode({data:this.join(),sampleRate:this.boundTo.sampleRate,channelCount:this.boundTo.channelCount,bytesPerSample:b})}),b}function p(){}function q(){}function r(a,b){r[a]=b,r._pluginList.push({plugin:b,name:a})}function s(a,b,c,d,e,f,g){this.sampleRate=isNaN(a)?this.sampleRate:a,this.attack=isNaN(b)?this.attack:b,this.decay=isNaN(c)?this.decay:c,this.sustain=isNaN(d)?this.sustain:d,this.release=isNaN(e)?this.release:e,this.sustainTime=isNaN(f)?null:f,this.releaseTime=isNaN(g)?null:g}function t(a,b,c,d){this.sampleRate=isNaN(a)?this.sampleRate:a,this.stepLength=isNaN(b)?this.stepLength:b,this.steps=c||[1,0],this.attack=isNaN(d)?this.attack:d}function u(a,b){this.sampleRate=isNaN(a)?this.sampleRate:a,this.schedule=[],this.reset(b)}function v(){this.reset.apply(this,arguments)}function w(a,b){var d=this,e=0;d.sampleRate=a,d.resolution=b?c.pow(2,b-1):c.pow(2,7),d.pushSample=function(a){return e=c.floor(a*d.resolution+.5)/d.resolution},d.getMix=function(){return e}}function x(a,b,d,e){function f(){h=new g(.1*k.sampleRate),i=0;var a,b=h.length;for(a=0;b>a;a++)h[a]=0}var h,i,j,k=this;k.delayTime=b||30,k.depth=d||3,k.freq=e||.1,k.sampleRate=a,k.osc=new J(a,e),k.calcCoeff=f,k.pushSample=function(a){++i>=h.length&&(i=0),h[i]=a,k.osc.generate();var b=k.delayTime+k.osc.getMix()*k.depth;for(b*=k.sampleRate/1e3,b=i-c.floor(b);0>b;)b+=h.length;return j=h[b]},k.getMix=function(){return j},f()}function y(a,b,c,d){var e=this;e.sampleRate=a,e.buffer=new g(isNaN(b)?1200:b),e.bufferSize=e.buffer.length,e.feedback=isNaN(c)?e.feedback:c,e.damping=isNaN(d)?e.damping:d,e.invDamping=1-e.damping}function z(a,b,c){var d=this,e=0;d.sampleRate=a,d.scale=b||1,d.gain=isNaN(c)?.5:c,d.pushSample=function(a){return a/=d.scale,e=(1+d.gain)*a-d.gain*a*a*a},d.getMix=function(){return e}}function A(a,b){this.sampleRate=isNaN(a)?this.sampleRate:a,this.setParam("kernels",b||new g(1))}function B(a,b,c){var d=this;d.time=isNaN(b)?d.time:b,d.feedback=isNaN(c)?d.feedback:c,d.reset(a)}function C(a){var b=new F(a,720.484),d=new F(a,723.431),e=new F(a,1),f=0;this.gain=4,this.master=1,this.sampleRate=a,this.filters=[b,d,e],this.pushSample=function(a){return b.pushSample(a),f=b.getMix(1)*this.gain,f=c.atan(f)+f,f>.4?f=.4:-.4>f&&(f=-.4),d.pushSample(f),e.pushSample(d.getMix(0)),f=e.getMix(1)*this.master},this.getMix=function(){return f}}function D(a,b,c,d,e,f,g){var h=this;h.sampleRate=a,h.channelCount=isNaN(b)?h.channelCount:b,h.wet=isNaN(c)?h.wet:c,h.dry=isNaN(d)?h.dry:d,h.roomSize=isNaN(e)?h.roomSize:e,h.damping=isNaN(f)?h.damping:f,h.tuning=new D.Tuning(g||h.tuning),h.sample=function(){var a,b=[];for(a=0;a<h.channelCount;a++)b[a]=0;return b}(),h.CFs=function(){var a,b,c=[],d=[],e=h.tuning.combCount,f=h.damping*h.tuning.scaleDamping,g=h.roomSize*h.tuning.scaleRoom+h.tuning.offsetRoom,i=h.tuning.combTuning;for(b=0;b<h.channelCount;b++){for(a=0;e>a;a++)d.push(new N.CombFilter(h.sampleRate,i[a]+b*h.tuning.stereoSpread,g,f));c.push(d),d=[]}return c}(),h.numCFs=h.CFs[0].length,h.APFs=function(){var a,b,c=[],d=[],e=h.tuning.allPassCount,f=h.tuning.allPassFeedback,g=h.tuning.allPassTuning;for(b=0;b<h.channelCount;b++){for(a=0;e>a;a++)d.push(new D.AllPassFilter(h.sampleRate,g[a]+b*h.tuning.stereoSpread,f));c.push(d),d=[]}return c}(),h.numAPFs=h.APFs[0].length}function E(a,b){this.sampleRate=isNaN(a)?this.sampleRate:a,this.gain=isNaN(b)?this.gain:b}function F(a,b,d,e){function f(){g=2*m(c.PI*n(.25,k.cutoff/(2*k.samplerate))),h=n(2*(1-o(k.resonance,.25)),n(2,2/g-.5*g))}var g,h,i,j,k=this,l=[0,0,0,0],m=c.sin,n=c.min,o=c.pow;k.cutoff=isNaN(b)?2e4:b,k.resonance=d?d:.1,k.samplerate=isNaN(a)?44100:a,k.type=e||0,k.pushSample=function(a){return(i!==k.cutoff||j!==k.resonance)&&(f(),i=k.cutoff,j=k.resonance),l[3]=a-h*l[2],l[0]=l[0]+g*l[2],l[1]=l[3]-l[0],l[2]=g*l[1]+l[2],l[3]=a-h*l[2],l[0]=l[0]+g*l[2],l[1]=l[3]-l[0],l[2]=g*l[1]+l[2],l[k.type]},k.getMix=function(a){return l[a||k.type]}}function G(a,b,c,d){this.sampleRate=isNaN(a)?this.sampleRate:a,this.threshold=isNaN(b)?this.threshold:b,this.attack=isNaN(c)?this.attack:c,this.release=isNaN(d)?this.release:d,this._amplitude=new N.Amplitude(this.sampleRate,this.attack,this.release)}function H(a,b,d){function e(){f=o*l.cutoff/l.samplerate,g=1-f/(2*(l.resonance+.5/(1+f))+f-2),h=g*g,i=h+1-2*c.cos(f)*g}var f,g,h,i,j,k,l=this,m=0,n=0,o=2*c.PI;l.cutoff=b?b:2e4,l.resonance=d?d:1,l.samplerate=a,l.pushSample=function(a){return(j!==l.cutoff||k!==l.resonance)&&(e(),j=l.cutoff,k=l.resonance),m+=(a-n)*i,n+=m,m*=h,n},l.getMix=function(){return n},e()}function I(){this.reset.apply(this,arguments)}function J(a,b){var c=this;c.frequency=isNaN(b)?440:b,c.waveTable=new g(1),c.sampleRate=a,c.waveShapes=c.waveShapes.slice(0)}function K(a,b){var c=this;c.voices=[],c.sampleRate=a,c.pitch=isNaN(b)?440:c.pitch}function L(a,b,c){this.sampleRate=isNaN(a)?this.sampleRate:a,this.attack=isNaN(b)?this.attack:b,this.decay=isNaN(c)?this.decay:c}f.list=[];var M=b.Float32Array||e,N=this;N.Float32Array=g;var O=function(){return d.defineProperty?d.defineProperty:d.prototype.__defineGetter__?function(a,b,c){c.get&&a.__defineGetter__(b,c.get),c.set&&a.__defineSetter__(b,c.set)}:void 0}();h(N,"__define",O),h(N,"__defineConst",h),h(N,"__extend",i),h(N,"__enum",j),h(N,"__class",k),l.prototype={parameter:"",automation:null,amount:1,type:"modulation",mode:null,setType:function(a){a?("function"==typeof a&&(this.type=a.name||"custom",this.mode=a),this.type=a,this.mode=m.modes[a]):this.mode=this.mode||m.modes[this.type]}},m.generatorAppend=function(a,b,c){var d,e,f,g,h,i=this,j=a.length,k=i.automation.length,l=[];for(c=c||a,b=b||i.channelCount,g=0;k>g;g++)l.push(i[i.automation[g].parameter]);for(e=0,d=0;j>e;e+=b,d++){for(g=0;k>g;g++)i[i.automation[g].parameter]=l[g];for(g=0;k>g;g++)h=i.automation[g],h.mode(i,h.parameter,h.amount*h.automation.generatedBuffer[d]);for(i.generate(),f=0;b>f;f++)c[e+f]=i.getMix(f)*i.mix+a[e+f]}for(g=0;k>g;g++)i[i.automation[g].parameter]=l[g];return c},m.effectAppend=function(a,b,c){var d,e,f,g,h,i=this,j=a.length,k=i.automation.length,l=[];for(c=c||a,b=b||i.channelCount,g=0;k>g;g++)l.push(i[i.automation[g].parameter]);for(e=0,d=0;j>e;e+=b,d++){for(g=0;k>g;g++)i[i.automation[g].parameter]=l[g];for(g=0;k>g;g++)h=i.automation[g],h.mode(i,h.parameter,h.amount*h.automation.generatedBuffer[d]);for(f=0;b>f;f++)i.pushSample(a[e+f],f),c[e+f]=i.getMix(f)*i.mix+a[e+f]*(1-i.mix)}for(g=0;k>g;g++)i[i.automation[g].parameter]=l[g];return c},m.bufferEffectAppend=function(a,b,c){var d,e,f,g,h,i=this,j=b||i.channelCount,k=a.length,l=i.automation.length,m=[];for(c=c||a,f=0;l>f;f++)for(m.push([]),e=0;j>e;e++)m[f].push(i.effects[e][i.automation[f].parameter]);for(h=0,d=0;k>d;d+=j,h++)for(e=0;j>e;e++){for(f=0;l>f;f++)g=i.automation[f],i.effects[e][g.parameter]=m[f][e],g.mode(i.effects[e],g.parameter,g.amount*g.automation.generatedBuffer[h]);c[d+e]=i.effects[e].pushSample(a[d+e])*i.mix+a[d+e]*(1-i.mix)}for(f=0;l>f;f++)for(e=0;j>e;e++)i.effects[e][i.automation[f].parameter]=m[f][e];return c},m.modes={modulation:function(a,b,c){a.setParam(b,a[b]*c)},addition:function(a,b,c){a.setParam(b,a[b]+c)},subtraction:function(a,b,c){a.setParam(b,a[b]-c)},additiveModulation:function(a,b,c){a.setParam(b,a[b]+a[b]*c)},subtractiveModulation:function(a,b,c){a.setParam(b,a[b]-a[b]*c)},assignment:function(a,b,c){a.setParam(b,c)},absoluteAssignment:function(a,b,d){a.setParam(b,c.abs(d))}},m.__constructror=l,f(function(){N.BufferEffect.prototype.addAutomation=N.EffectClass.prototype.addAutomation=N.GeneratorClass.prototype.addAutomation=function(){return N.Automation.apply(N,[this].concat([].slice.call(arguments)))}}),n.prototype={mix:.5,type:"buffereffect",channelCount:2,append:function(a,b,c){var d,e,f=this,g=a.length;for(b=b||f.channelCount,c=c||a,d=0;g>d;d+=b)for(e=0;b>e;e++)f.effects[e].pushSample(a[d+e],0),c[d+e]=f.effects[e].getMix(0)*f.mix+a[d+e]*(1-f.mix);return c},addPreProcessing:function(){var a;for(a=0;a<this.effects.length;a++)this.effects[a].addPreProcessing.apply(this.effects[a],arguments)},removePreProcessing:function(){var a;for(a=0;a<this.effects.length;a++)this.effects[a].removePreProcessing.apply(this.effects[a],arguments)},setParam:function(a,b){var c,d=this.effects.length;for(c=0;d>c;c++)this.effects[c].setParam(a,b)}},f(function(){N.EffectClass.createBufferBased=function(a){return new N.BufferEffect(this,a,[].slice.call(arguments,1))}}),p.prototype={type:"effect",sink:!0,source:!0,mix:.5,channelCount:1,append:function(a,b,c){var d,e,f=a.length;for(c=c||a,b=b||this.channelCount,d=0;f>d;d+=b)for(e=0;b>e;e++)this.pushSample(a[d+e],e),c[d+e]=this.getMix(e)*this.mix+a[d+e]*(1-this.mix);return c},addPreProcessing:function(a){a.pushSample=this.pushSample,this.pushSample=function(){return a.apply(this,arguments),a.pushSample.apply(this,arguments)}},removePreProcessing:function(a){for(var b;b=this.pushSample.pushSample;)b!==a&&a||(this.pushSample=b,a.pushSample=null)},setParam:function(a,b){this[a]=b},pushSample:function(){},getMix:function(){},reset:function(){}},f(function(){function a(a,b,c,d){var f,g,h,i,j;b?d||b instanceof e||"object"!=typeof b||(d=b,b=[]):b=[],d=d||{},c=c||4096,"number"==typeof c?f=new Float64Array(c):(f=c,c=f.length),i=this.apply(N,b);for(j in d)d.hasOwnProperty(j)&&i.setParam(j,d[j]);return h=N.FFT(i.sampleRate||44100,c/2,!1),g=new Float64Array(c/2),a&&a(g),i.append(g,1),h._process(f,g,"real"),f}p.getFrequencyResponse=function(b,c,d){return a.call(this,function(a){a[0]=a.length/2},b,c,d)},q.getFrequencyResponse=function(b,c,d){return a.call(this,null,b,c,d)}}),q.prototype={type:"generator",source:!0,mix:1,generatedBuffer:null,channelCount:1,append:function(a,b,c){var d,e,f=a.length;for(c=c||a,b=b||this.channelCount,d=0;f>d;d+=b)for(this.generate(),e=0;b>e;e++)c[d+e]=this.getMix(e)*this.mix+a[d+e];return c},addPreProcessing:function(a){a.generate=this.generate,this.generate=function(){return a.apply(this,arguments),a.generate.apply(this,arguments)}},removePreProcessing:function(a){for(var b;b=this.generate.generate;)b!==a&&a||(this.generate=b,a.generate=null)},generateBuffer:function(a,b){this.generatedBuffer=new g(a),this.append(this.generatedBuffer,b||1)},setParam:function(a,b){this[a]=b},generate:function(){},getMix:function(){},reset:function(){}},h(r,"_pluginList",[],!1),s.prototype={sampleRate:44100,attack:50,decay:50,sustain:1,release:50,sustainTime:null,releaseTime:null,gate:!1,state:3,value:0,_st:0,generate:function(){return this.states[this.state].call(this),this.value},getMix:function(){return this.value},triggerGate:function(a){a="undefined"==typeof a?!this.gate:a,this.gate=a,this.state=a?0:null===this.releaseTime?3:5,this._st=0},states:[function(){this.value+=1e3/this.sampleRate/this.attack,this.value>=1&&(this.state=1)},function(){this.value-=1e3/this.sampleRate/this.decay*this.sustain,this.value<=this.sustain&&(null===this.sustainTime?this.state=2:(this._st=0,this.state=4))},function(){this.value=this.sustain},function(){this.value=c.max(0,this.value-1e3/this.sampleRate/this.release)},function(){this.value=this.sustain,this._st++>=.001*this.sampleRate*this.sustainTime&&(this._st=0,this.state=null===this.releaseTime?3:5)},function(){this.value=c.max(0,this.value-1e3/this.sampleRate/this.release),this._st++>=.001*this.sampleRate*this.releaseTime&&(this._st=0,this.state=0)}]},t.prototype={sampleRate:44100,stepLength:200,steps:null,attack:0,phase:0,value:0,generate:function(){var a,b,c,d,e,f=this,g=f.sampleRate/1e3*f.stepLength,h=f.steps,i=g*h.length;return f.phase=(f.phase+1)%i,a=f.phase/i*h.length,b=a%1,a=~~a,c=(a||h.length)-1,d=h[a]-h[c],e=h[a],b<f.attack&&(e-=d-d/f.attack*b),f.value=e,e},getMix:function(){return this.value},triggerGate:function(){this.phase=0}},u.prototype={sampleRate:44100,value:1,schedule:null,clock:0,getMix:function(){return this.value},generate:function(){var a;for(a=0;a<this.schedule.length;a++)this.schedule[a].t--&&(this.value=this.schedule[a].v,this.schedule.splice(a--,1))},setValue:function(a){this.schedule.push({v:a,t:~~((+new Date-this.clock)/1e3*this.sampleRate)})},reset:function(a){this.value=isNaN(a)?this.value:a,this.clock=+new Date}},v.BiquadFilterClass=function R(){var a;for(a in R.prototype)R.prototype.hasOwnProperty&&(this[a]=this[a])},v.BiquadFilterClass.prototype={sampleRate:44100,sample:0,inputs:null,outputs:null,coefs:null,pushSample:function(a){var b=this.coefs,c=this.inputs,d=this.outputs;return this.sample=b.b0*a+b.b1*c[0]+b.b2*c[1]-b.a1*d[0]-b.a2*d[1],c.pop(),c.unshift(a),d.pop(),d.unshift(this.sample),this.sample},getMix:function(){return this.sample},reset:function(a,b,c,d,e,f){this.inputs=[0,0],this.outputs=[0,0],this.sampleRate=isNaN(a)?this.sampleRate:a,arguments.length>1&&(this.coefs={b0:b,b1:c,b2:d,a1:e,a2:f})}},v.LowPass=function(a,b,d){var e=2*c.PI*b/a,f=c.cos(e),g=c.sin(e),h=g/(2*d),i=(1-f)/2,j=1-f,k=i,l=1+h,m=-2*f,n=1-h;this.reset(a,i/l,j/l,k/l,m/l,n/l)},v.HighPass=function(a,b,d){var e=2*c.PI*b/a,f=c.cos(e),g=c.sin(e),h=g/(2*d),i=(1+f)/2,j=-(1+f),k=i,l=1+h,m=-2*f,n=1-h;this.reset(a,i/l,j/l,k/l,m/l,n/l)},v.AllPass=function(a,b,d){var e=2*c.PI*b/a,f=c.cos(e),g=c.sin(e),h=g/(2*d),i=1-h,j=-2*f,k=1+h,l=k,m=j,n=i;this.reset(a,i/l,j/l,k/l,m/l,n/l)},v.BandPass=function(a,b,d){var e=2*c.PI*b/a,f=c.cos(e),g=c.sin(e),h=c.log(2)/2*d*e/g,i=g*(c.exp(h)-c.exp(-h))/2,j=i,k=0,l=-i,m=1+i,n=-2*f,o=1-i;this.reset(a,j/m,k/m,l/m,n/m,o/m)},function(a,b){for(b=0;b<a.length;b++)a[b].prototype=new v.BiquadFilterClass}([v,v.LowPass,v.HighPass,v.AllPass,v.BandPass]),y.prototype={sample:0,index:0,store:0,feedback:.84,damping:.2,pushSample:function(a){var b=this;return b.sample=b.buffer[b.index],b.store=b.sample*b.invDamping+b.store*b.damping,b.buffer[b.index++]=a+b.store*b.feedback,b.index>=b.bufferSize&&(b.index=0),b.sample},getMix:function(){return this.sample},reset:function(){this.index=this.store=0,this.samples=0,this.buffer=new g(this.bufferSize)},setParam:function(a,b){switch(a){case"damping":this.damping=b,this.invDamping=1-b;break;default:this[a]=b}}},A.prototype={sampleRate:44100,sample:0,pos:0,kernels:null,buffer:null,pushSample:function(a){var b,c,d;for(this.sample=0,this.buffer[this.pos]=a,c=0,d=this.buffer.length,b=this.pos+d;d>c;c++)this.sample+=this.kernels[c]*this.buffer[(b-c)%d];this.pos=(this.pos+1)%this.buffer.length},getMix:function(){return this.sample},setParam:function(a,b){switch(a){case"kernels":this.buffer=new g(b.length),this.pos=0}this[a]=b}},B.prototype={sampleRate:1,time:1e3,feedback:0,bufferPos:0,buffer:null,sample:0,_rstf:1,pushSample:function(a){var b=this,c=b.buffer;return c[b.bufferPos++]+=a,b.bufferPos>b.time*b._rstf&&(b.bufferPos=0),b.sample=c[b.bufferPos],c[b.bufferPos]*=b.feedback,b.sample},getMix:function(){return this.sample},resample:function(a){var b=this,d=b.time/a;return b.buffer=N.Sink.resample(b.buffer,a),b.time=a,b.bufferPos=c.round(d*b.bufferPos),b.buffer},reset:function(a,b){var d,e,f=this,h=f.buffer;if(a=isNaN(a)?f.sampleRate:a,e=f.sampleRate/a,f.buffer=new g(a*B.MAX_DELAY),f.bufferPos=c.round(e*f.bufferPos),f._rstf=.001*a,b)for(h=N.Sink.resample(h,e),d=0;d<h.length&&d<f.buffer.length;d++)f.buffer[d]=h[d];return f.buffer}},B.MAX_DELAY=2,D.prototype={channelCount:2,sample:[0,0],wet:.5,dry:.55,damping:.2223,roomSize:.5,tuning:{},pushSample:function(a,b){var c,d=a*this.tuning.fixedGain,e=0;for(c=0;c<this.numCFs;c++)e+=this.CFs[b][c].pushSample(d);for(c=0;c<this.numAPFs;c++)e=this.APFs[b][c].pushSample(e);this.sample[b]=e*this.wet+a*this.dry},getMix:function(a){return this.sample[a]},reset:function(){var a,b;for(b=0;b<this.channelCount;b++){for(a=0;a<this.numCFs;a++)this.CFs[b][a].reset();for(a=0;a<this.numAPFs;a++)this.APFs[b][a].reset();this.sample[b]=0}},setParam:function(a,b){var c,d,e,f;switch(a){case"roomSize":for(this.roomSize=b,c=this.roomSize*this.tuning.scaleRoom+this.tuning.offsetRoom,f=0;f<this.channelCount;f++)for(e=0;e<this.numCFs;e++)this.CFs[f][e].setParam("feedback",c);break;case"damping":for(this.damping=b,d=this.damping*this.tuning.scaleDamping,f=0;f<this.channelCount;f++)for(e=0;e<this.numCFs;e++)this.CFs[f][e].setParam("damping",d);break;default:this[a]=b}}},D.Tuning=function(a){var b;if(a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])},D.Tuning.prototype={combCount:8,combTuning:[1116,1188,1277,1356,1422,1491,1557,1617],allPassCount:4,allPassTuning:[556,441,341,225],allPassFeedback:.5,fixedGain:.015,scaleDamping:.9,scaleRoom:.28,offsetRoom:.7,stereoSpread:23},D.AllPassFilter=function(a,b,c){var d=this;d.sampleRate=a,d.buffer=new g(isNaN(b)?500:b),d.bufferSize=d.buffer.length,d.feedback=isNaN(c)?d.feedback:c},D.AllPassFilter.prototype={sample:0,index:0,feedback:.5,pushSample:function(a){var b=this;return bufOut=b.buffer[b.index],b.sample=-a+bufOut,b.buffer[b.index++]=a+bufOut*b.feedback,b.index>=b.bufferSize&&(b.index=0),b.sample},getMix:function(){return this.sample},reset:function(){this.index=0,this.sample=0,this.buffer=new g(this.bufferSize)}},E.prototype={sampleRate:44100,gain:1,sample:0,pushSample:function(a){return this.sample=a*this.gain,this.sample},getMix:function(){return this.sample}},G.prototype={sampleRate:44100,threshold:.95,attack:.01,release:.01,__amplitude:null,sample:0,pushSample:function(a){var b=this._amplitude.pushSample(a)-this.threshold;return this.sample=b>0?a/(1+b):a,this.sample},getMix:function(){return this.sample},setParam:function(a,b){switch(a){case"attack":case"release":this._amplitude[a]=b,this[a]=b;break;default:this[a]=b}}},I.prototype={sampleRate:44100,color:"white",b0:0,b1:0,b2:0,b3:0,b4:0,b5:0,c1:null,c2:null,c3:null,c4:null,q:15,q0:null,q1:null,brownQ:0,value:0,reset:function(a,b){this.sampleRate=isNaN(a)?this.sampleRate:a,this.color="string"==typeof b?b:this.color,this.c1=(1<<this.q)-1,this.c2=~~(this.c1/3)+1,this.c3=1/this.c1,this.c1=6*this.c2,this.c4=3*(this.c2-1),this.q0=c.exp(-200*c.PI/this.sampleRate),this.q1=1-this.q0},generate:function(){this.value=this[this.color]()},getMix:function(){return this.value},white:function(){var a=c.random();return(a*this.c1-this.c4)*this.c3},pink:function(){var a=this.white();return this.b0=.997*this.b0+.029591*a,this.b1=.985*this.b1+.032534*a,this.b2=.95*this.b2+.048056*a,this.b3=.85*this.b3+.090579*a,this.b4=.62*this.b4+.10899*a,this.b5=.25*this.b5+.255784*a,.55*(this.b0+this.b1+this.b2+this.b3+this.b4+this.b5)},brown:function(){var a=this.white();return this.brownQ=this.q1*a+this.q0*this.brownQ,6.2*this.brownQ}},function(a,b,d,e){for(d=J.prototype={sampleRate:44100,frequency:440,phaseOffset:0,pulseWidth:.5,fm:0,waveShape:"sine",phase:0,_p:0,generate:function(){var a=this,b=+a.frequency,c=a.pulseWidth,d=a.phase;b+=b*a.fm,a.phase=(d+b/a.sampleRate/2)%1,d=(a.phase+a.phaseOffset)%1,a._p=c>d?d/c:(d-c)/(1-c)},getMix:function(){return this[this.waveShape]()},getPhase:function(){return this._p},reset:function(a){this.phase=this._p=isNaN(a)?0:a},setWavetable:function(a){return this.waveTable=a,!0},sine:function(){return c.sin(this._p*a)},triangle:function(){return this._p<.5?4*this._p-1:3-4*this._p},square:function(){return this._p<.5?-1:1},sawtooth:function(){return 1-2*this._p},invSawtooth:function(){return 2*this._p-1},pulse:function(){return this._p<.5?this._p<.25?8*this._p-1:1-8*(this._p-.25):-1},wavetable:function(){return N.Sink.interpolate(this.waveTable,this._p*this.waveTable.length)},waveShapes:[]},e=0;e<b.length;e++)d[e]=d[b[e]],d.waveShapes.push(d[e]);J.WaveShape=function(a,b){return b&&(this.prototype[a]=b),this.prototype[a]},J.createMixWave=function(a,b){var c,d,e=b.length;return this.WaveShape(a,function(){for(c=0,d=0;e>d;d++)c+=this[b[d].shape]()*b[d].mix;return c})}}(2*c.PI,["sine","triangle","pulse","sawtooth","invSawtooth","square"]),K.prototype={sampleRate:44100,pitch:440,delayStart:0,delayEnd:0,maxVoices:1/0,sampleSize:0,voices:null,sample:null,samples:null,data:null,noteOn:function(a,b){a=isNaN(a)?this.pitch:a;var c=this,d=a/c.pitch,e=c.sampleRate,f=e*c.delayStart,g=c.sampleSize-e*c.delayEnd-1,h={f:a,p:f,s:d,l:g,v:isNaN(b)?1:b};for(c.voices.push(h);c.voices.length>c.maxVoices;)g=c.voices.shift(),g.onend&&g.onend();return h},generate:function(){var a,b,c=this.voices;for(a=0;a<c.length;a++)b=c[a],b.p+=b.s,b.p>b.l&&c.splice(a--,1)&&b.onend&&b.onend()},getMix:function(a){var b,c=this.voices,d=0;if(a=a||0,this.samples[a])for(b=0;b<c.length;b++)d+=N.Sink.interpolate(this.samples[a],c[b].p)*c[b].v;return d},load:function(a,b){var c,d=this,e=d.samples=N.Sink.deinterleave(a.data,a.channelCount);if(b)for(c=0;c<e.length;c++)e[c]=N.Sink.resample(e[c],a.sampleRate,d.sampleRate);d.sample=a.data,d.samples=e,d.data=a,d.sampleSize=e[0].length}},function(){function b(){var a,b,c=arguments,d=c.length;for(b=0;d>b;b++)a=c[b],this.postMessage({type:"injection",code:a instanceof Function?"("+String(a)+").call(this);":a})}N.AudioWorker=function(c,d){var e,f="var audioLib=("+String(a)+").call({},this,Math,Object,Array);\n";for(e=0;e<N.plugins._pluginList.length;e++)f+="("+String(N.plugins._pluginList[url])+"());\n";return d&&(f+='this.addEventListener("message",function(e){e.data&&e.data.type==="injection"&&Function(e.data.code).call(this)},true);\n'),f+=c instanceof Function?"("+String(c)+").call(this);":c.textContent||c,f=P.inlineWorker(f),d&&(f.inject=b),f}}(),function(a,b){function c(a,b){return b?h(255&a)+c(a>>8,b-1):""}function d(a,b){return b?d(a>>8,b-1)+h(255-a&255):""}function e(a,b,e){return e?d(a,b):c(a,b)}function f(a,c){var d,e=a.length,f=e-1,g=0,h=b.pow;if(c)for(d=0;e>d;d++)g+=(255-a.charCodeAt(d))*h(256,f-d);else for(d=0;e>d;d++)g+=a.charCodeAt(d)*h(256,d);return g}function g(a,c,d,e){var f=b.pow,h=b.floor,i=g.convertFromBinary,j=g.convertToBinary,k=a/8,l=f(2,a),m=l/2,n=m-1,o=1/m,p=1/n;return e?d?c?function(a,b){return a=h(0>a?a*m+l:a*n),j(a,k,b)}:function(a,b){return j(h(a*n),k,b)}:c?function(a,b){return j(0>a?a+l:a,k,b)}:function(a,b){return j(a,k,b)}:d?c?function(a,b){var c=i(a,b);return c>n?(c-l)*o:c*p}:function(a,b){return i(a,b)*p}:c?function(a,b){var c=i(a,b);return c>n?c-l:c}:function(a,b){return i(a,b)}}var h=String.fromCharCode,i=!0,j=!1;g.convertToBinary=e,g.convertFromBinary=f,g.fromQ32=g(32,i,i,i),g.toQ32=g(32,i,i,j),g.fromQ24=g(24,i,i,i),g.toQ24=g(24,i,i,j),g.fromQ16=g(16,i,i,i),g.toQ16=g(16,i,i,j),g.fromQ8=g(8,i,i,i),g.toQ8=g(8,i,i,j),g.fromInt32=g(32,i,j,i),g.toInt32=g(32,i,j,j),g.fromInt16=g(16,i,j,i),g.toInt16=g(16,i,j,j),g.fromInt8=g(8,i,j,i),g.toInt8=g(8,i,j,j),g.fromUint32=g(32,j,j,i),g.toUint32=g(32,j,j,j),g.fromUint16=g(16,j,j,i),g.toUint16=g(16,j,j,j),g.fromUint8=g(8,j,j,i),g.toUint8=g(8,j,j,j),a.Binary=g}(this,c),function(a,b){function c(a){this.data=a}function d(a,b,c){var d=b/8;g["read"+a+b]=function(a){return c(this.read(d),a)}}var e,f,g=c.prototype={read:function(a){var b=this,c=b.data.substr(0,a);return b.skip(a),c},skip:function(a){var b=this,c=b.data=b.data.substr(a);return b.pointer+=a,c.length},readBuffer:function(a,b,c){for(var d=this,e="read"+c+b,f=a.length,g=0;d.data&&f>g;)a[g++]=d[e]();return g}};for(e in b)f=/to([a-z]+)([0-9]+)/i.exec(e),f&&d(f[1],f[2],b[e]);a.Stream=c,c.newType=d}(this,this.Binary),this.PCMData=function(a,b){function d(a){return("string"==typeof a?d.decode:d.encode)(a)}var f="undefined"==typeof Uint8Array?e:Uint8Array;return d.decodeFrame=function(a,c,d){if(8===c){var e=new f(d.length);for(new b(a).readBuffer(e,8,"Uint"),c=0;c<d.length;c++)d[c]=127.5*(e[c]-127.5)
}else new b(a).readBuffer(d,c,"Q");return d},d.encodeFrame=function(b,c){var d,e=a[(8===c?"fromUint":"fromQ")+c],f=b.length,g="";if(8===c)for(d=0;f>d;d++)g+=e(127.5*b[d]+127.5);else for(d=0;f>d;d++)g+=e(b[d]);return g},d.decode=function(a,c){function e(){i=f.read(4),j=f.readUint32(),l=f.read(j),n=u[i]=u[i]||[],"data"===i?(k=~~(j/t),m=v.data=new g(k),d.decodeFrame(l,8*t,m)):n.push(l),c&&(f.data?setTimeout(e,1):c(v))}var f=new b(a),h=(f.read(4),f.readUint32());f=new b(f.read(h));var i,j,k,l,m,n,o=(f.read(4),f.read(4),f.readUint32()),p=new b(f.read(o)),q=(p.readUint16(),p.readUint16()),r=(p.readUint32(),p.readUint32()),s=p.readUint16(),t=s/q,u=(p.readUint16(),{}),v={channelCount:q,bytesPerSample:s/q,sampleRate:r/s,chunks:u,data:m};if(c)f.data?e():c(v);else for(;f.data;)e();return v},d.encode=function(b,e){var f,g,h,i,j=a.fromUint32,k=a.fromUint16,l=b.data,m=b.sampleRate,n=b.channelCount||1,o=b.bytesPerSample||1,p=8*o,q=n*o,r=m*q,s=l.length,t=s*o,u=(c.pow(2,p-1)-1,[]),v="";if(u.push("fmt "+j(16)+k(1)+k(n)+j(m)+j(r)+k(q)+k(p)),u.push("data"+j(t)+d.encodeFrame(l,p)),i=b.chunks)for(g in i)if(i.hasOwnProperty(g))for(f=i[g],h=0;h<f.length;h++)v=f[h],u.push(g+j(v.length)+v);return u=u.join(""),u="RIFF"+j(u.length)+"WAVE"+u,e&&setTimeout(function(){e(u)},1),u},d}(this.Binary,this.Stream);var P=this.Sink=function(a){function b(a,c,d,e){var f,g=b.sinks.list;for(f=0;f<g.length;f++)if(g[f].enabled)try{return new g[f](a,c,d,e)}catch(h){}throw b.Error(2)}function c(){}function d(a,c,e,f,g){e=e||c.prototype,c.prototype=new b.SinkClass,c.prototype.type=a,c.enabled=!f;var h;for(h in e)e.hasOwnProperty(h)&&(c.prototype[h]=e[h]);d[a]=c,d.list[g?"unshift":"push"](c)}return b.SinkClass=c,c.prototype=b.prototype={sampleRate:44100,channelCount:2,bufferSize:4096,writePosition:0,previousHit:0,ringOffset:0,channelMode:"interleaved",isReady:!1,start:function(a,c,d,e){this.channelCount=isNaN(c)||null===c?this.channelCount:c,this.bufferSize=isNaN(d)||null===d?this.bufferSize:d,this.sampleRate=isNaN(e)||null===e?this.sampleRate:e,this.readFn=a,this.activeRecordings=[],this.previousHit=+new Date,b.EventEmitter.call(this),b.emit("init",[this].concat([].slice.call(arguments)))},process:function(a,c){if(this.emit("preprocess",arguments),this.ringBuffer&&("interleaved"===this.channelMode?this.ringSpin:this.ringSpinInterleaved).apply(this,arguments),"interleaved"===this.channelMode)this.emit("audioprocess",arguments),this.readFn&&this.readFn.apply(this,arguments);else{var d=b.deinterleave(a,this.channelCount),e=[d].concat([].slice.call(arguments,1));this.emit("audioprocess",e),this.readFn&&this.readFn.apply(this,e),b.interleave(d,this.channelCount,a)}this.emit("postprocess",arguments),this.previousHit=+new Date,this.writePosition+=a.length/c},getPlaybackTime:function(){return this.writePosition-this.bufferSize},ready:function(){this.isReady||(this.isReady=!0,this.emit("ready",[]))}},b.sinks=b.devices=d,b.sinks.list=[],b.singleton=function(){var a=b.apply(null,arguments);return b.singleton=function(){return a},a},a.Sink=b,b}(function(){return this}());void function(a){function b(){var a;for(a in b.prototype)b.prototype.hasOwnProperty(a)&&(this[a]=b.prototype[a]);this._listeners={}}b.prototype={_listeners:null,emit:function(a,b){if(this._listeners[a])for(var c=0;c<this._listeners[a].length;c++)this._listeners[a][c].apply(this,b);return this},on:function(a,b){return this._listeners[a]=this._listeners[a]||[],this._listeners[a].push(b),this},off:function(a,b){if(this._listeners[a]){if(!b)return delete this._listeners[a],this;for(var c=0;c<this._listeners[a].length;c++)this._listeners[a][c]===b&&this._listeners[a].splice(c--,1);this._listeners[a].length||delete this._listeners[a]}return this}},a.EventEmitter=b,b.call(a)}(this.Sink),void function(a){function b(a){if(!b.hasOwnProperty(a))throw b(1);if(!(this instanceof b))return new b(a);var c;for(c in b[a])b[a].hasOwnProperty(c)&&(this[c]=b[a][c]);this.code=a}b.prototype=new Error,b.prototype.toString=function(){return"SinkError 0x"+this.code.toString(16)+": "+this.message},b[1]={message:"No such error code.",explanation:"The error code does not exist."},b[2]={message:"No audio sink available.",explanation:"The audio device may be busy, or no supported output API is available for this browser."},b[16]={message:"Buffer underflow.",explanation:"Trying to recover..."},b[17]={message:"Critical recovery fail.",explanation:"The buffer underflow has reached a critical point, trying to recover, but will probably fail anyway."},b[18]={message:"Buffer size too large.",explanation:"Unable to allocate the buffer due to excessive length, please try a smaller buffer. Buffer size should probably be smaller than the sample rate."},a.Error=b}(this.Sink),void function(a){var b,c,d,e;void function(a,f){function g(a,b){var c,d=b.slice();for(c=d.shift();"undefined"!=typeof c;c=d.shift())if(c=Function("return typeof "+c+a+'=== "undefined" ? undefined : '+c+a)())return c}b=g("Blob",a),c=g("BlobBuilder",a),d=g("URL",f),e=g("btoa",[""])}(["","Moz","WebKit","MS"],["","webkit"]);var f=b&&d&&function(a,c){return d.createObjectURL(new b([a],{type:c}))},g=c&&d&&function(a,b){var e=new c;return e.append(a),d.createObjectURL(e.getBlob(b))},h=e&&function(a,b){return"data:"+b+";base64,"+e(a)},i=f||g||h;i&&(f&&(i.createBlob=f),g&&(i.createBlobBuilder=g),h&&(i.createData=h),b&&(i.Blob=b),c&&(i.BlobBuilder=c),d&&(i.URL=d),a.createDynURL=i,a.revokeDynURL=function(a){return"string"==typeof a&&0===a.indexOf("data:")?!1:d.revokeObjectURL(a)})}(this.Sink),void function(a){function b(){return e(this,"terminate",this._terminate),a.revokeDynURL(this._url),delete this._url,delete this._terminate,this.terminate()}function c(d){function f(a,d,f){try{var g=a(d,"text/javascript"),h=new Worker(g);return e(h,"_url",g),e(h,"_terminate",h.terminate),e(h,"terminate",b),c.type?h:(c.type=f,c.createURL=a,h)}catch(i){return null}}var g=a.createDynURL;if(!g)return null;var h;return c.createURL?f(c.createURL,d,c.type):(h=f(g.createBlob,d,"blob"))?h:(h=f(g.createBlobBuilder,d,"blobbuilder"))?h:h=f(g.createData,d,"data")}var e=d.defineProperty?function(a,b,c){d.defineProperty(a,b,{value:c,configurable:!0,writable:!0})}:function(a,b,c){a[b]=c};a.EventEmitter.call(c),c.test=function(){function a(a){c.ready||(c.ready=!0,c.working=a,c.emit("ready",[a]),c.off("ready"),a&&b&&b.terminate(),b=null)}c.ready=c.working=!1,c.type="",c.createURL=null;var b=c("this.onmessage=function(e){postMessage(e.data)}"),d="inlineWorker";b?(b.onmessage=function(b){a(b.data===d)},b.postMessage(d),setTimeout(function(){a(!1)},1e3)):setTimeout(function(){a(!1)},0)},a.inlineWorker=c,c.test()}(this.Sink),void function(a){a.doInterval=function(b,c){function d(d){a.inlineWorker.working&&!d?(e=a.inlineWorker('setInterval(function (){ postMessage("tic"); }, '+c+");"),e.onmessage=function(){b()},f=function(){e.terminate()}):(e=setInterval(b,c),f=function(){clearInterval(e)})}var e,f;return a.inlineWorker.ready?d():a.inlineWorker.on("ready",function(){d()}),function(){f?f():a.inlineWorker.ready||a.inlineWorker.on("ready",function(){f&&f()})}}}(this.Sink),void function(a){a.sinks("audiodata",function(){function b(){if(k){if(c=l.mozWriteAudio(k),j+=c,c<k.length)return k=k.subarray(c);k=null}if(d=l.mozCurrentSampleOffset(),e=Number(d+(h!==d?i.bufferSize:i.preBufferSize)*i.channelCount-j),d===h&&i.emit("error",[a.Error(16)]),e>0||h===d){i.ready();try{f=new g(h===d?i.preBufferSize*i.channelCount:i.forceBufferSize&&e<2*i.bufferSize?2*i.bufferSize:e)}catch(b){return i.emit("error",[a.Error(18)]),void i.kill()}i.process(f,i.channelCount),c=i._audio.mozWriteAudio(f),c<f.length&&(k=f.subarray(c)),j+=c}h=d}var c,d,e,f,h,i=this,j=0,k=null,l=new Audio;i.start.apply(i,arguments),i.preBufferSize=isNaN(arguments[4])||null===arguments[4]?this.preBufferSize:arguments[4],l.mozSetup(i.channelCount,i.sampleRate),this._timers=[],this._timers.push(a.doInterval(function(){+new Date-i.previousHit>2e3&&(i._audio=l=new Audio,l.mozSetup(i.channelCount,i.sampleRate),j=0,i.emit("error",[a.Error(17)]))},1e3)),this._timers.push(a.doInterval(b,i.interval)),i._bufferFill=b,i._audio=l},{bufferSize:24576,preBufferSize:24576,forceBufferSize:!1,interval:100,kill:function(){for(;this._timers.length;)this._timers.shift()();this.emit("kill")},getPlaybackTime:function(){return this._audio.mozCurrentSampleOffset()/this.channelCount}},!1,!0),a.sinks.moz=a.sinks.audiodata}(this.Sink),function(a,b){function c(a){var b=document.createElement("audio");return a&&(b.src=a),b}function d(){var a=this;a.currentFrame=c(),a.nextFrame=c(),a._onended=function(){a.samples+=a.bufferSize,a.nextClip()}}b=a.sinks,b("wav",function(){function d(){e._audio.hasNextFrame||(e.ready(),a.memcpy(j,0,i,0),e.process(i,e.channelCount),e._audio.setSource("data:audio/wav;base64,"+btoa(N.PCMData.encode({data:i,sampleRate:e.sampleRate,channelCount:e.channelCount,bytesPerSample:e.quality}))),e._audio.currentFrame.src||e._audio.nextClip())}var e=this,f=new b.wav.wavAudio,h="undefined"==typeof h?N.PCMData:h;e.start.apply(e,arguments);var i=new g(e.bufferSize*e.channelCount),j=new g(e.bufferSize*e.channelCount);if(!c().canPlayType("audio/wav; codecs=1")||!btoa)throw 0;e.kill=a.doInterval(d,40),e._bufferFill=d,e._audio=f},{quality:1,bufferSize:22050,getPlaybackTime:function(){var a=this._audio;return(a.currentFrame?a.currentFrame.currentTime*this.sampleRate:0)+a.samples}}),d.prototype={samples:0,nextFrame:null,currentFrame:null,_onended:null,hasNextFrame:!1,nextClip:function(){var a=this.currentFrame;this.currentFrame=this.nextFrame,this.nextFrame=a,this.hasNextFrame=!1,this.currentFrame.play()},setSource:function(a){this.nextFrame.src=a,this.nextFrame.addEventListener("ended",this._onended,!0),this.hasNextFrame=!0}},b.wav.wavAudio=d}(this.Sink),void function(a){var b;try{b=require("cubeb")}catch(c){return}var d=function(){var a;return function(){return a=new b.Context("sink.js "+process.pid+" "+new Date),d=function(){return a},a}}(),e=0;a.sinks("cubeb",function(){var a=this;a.start.apply(a,arguments),a._ctx=d(),a._stream=new b.Stream(a._ctx,a._ctx.name+" "+e++,b.SAMPLE_FLOAT32LE,a.channelCount,a.sampleRate,a.bufferSize,a._latency,function(b){var c=new Buffer(4*b*a.channelCount),d=new g(c);a.process(d,a.channelCount),a._stream.write(c),a._stream.release()},function(){}),a._stream.start()},{_ctx:null,_stream:null,_latency:250,bufferSize:4096,kill:function(){this._stream.stop(),this.emit("kill")}})}(this.Sink),void function(a){a.sinks("dummy",function(){function b(){var a=new g(c.bufferSize*c.channelCount);c.process(a,c.channelCount)}var c=this;c.start.apply(c,arguments),c._kill=a.doInterval(b,c.bufferSize/c.sampleRate*1e3),c._callback=b},{kill:function(){this._kill(),this.emit("kill")}},!0)}(this.Sink),function(a,b){var c="undefined"==typeof window?null:window.webkitAudioContext||window.AudioContext;a("webaudio",function(){function c(a){var b,c,f=a.outputBuffer,h=f.numberOfChannels,k=f.length,l=(f.size,new e(h));for(d.ready(),i=i&&i.length===k*h?i:new g(k*h),j=j&&j.length===i.length?j:new g(k*h),i.set(j),b=0;h>b;b++)l[b]=f.getChannelData(b);for(d.process(i,d.channelCount),b=0;k>b;b++)for(c=0;h>c;c++)l[c][b]=i[b*d.channelCount+c]}var d=this,f=a.webaudio.getContext(),h=null,i=null,j=null;d.start.apply(d,arguments),h=f.createJavaScriptNode(d.bufferSize,d.channelCount,d.channelCount),d.sampleRate=f.sampleRate,h.onaudioprocess=c,h.connect(f.destination),d._context=f,d._node=h,d._callback=c,b.push(h)},{kill:function(){this._node.disconnect(0);for(var a=0;a<b.length;a++)b[a]===this._node&&b.splice(a--,1);this._node=this._context=null,this.emit("kill")},getPlaybackTime:function(){return this._context.currentTime*this.sampleRate}},!1,!0),a.webkit=a.webaudio,a.webaudio.fix82795=b,a.webaudio.getContext=function(){var b=new c;return a.webaudio.getContext=function(){return b},b}}(this.Sink.sinks,[]),function(a){a.sinks("worker",function(){function a(a){c.isReady||c.initMSP(a),c.ready();var b,d,e=c.channelCount,j=a.audioLength;for(f=f&&f.length===j*e?f:new g(j*e),h=h&&h.length===f.length?h:new g(j*e),i=i&&i.length===f.length?i:new g(j*e),f.set(i),h.set(i),c.process(f,c.channelCount),b=0;e>b;b++)for(d=0;j>d;d++)h[b*a.audioLength+d]=f[b+d*e];a.writeAudio(h)}function b(a){c.isReady||c.initWA(a),c.ready();var b,d,h=a.outputBuffer,j=h.numberOfChannels,k=h.length,l=(h.size,new e(j));for(f=f&&f.length===k*j?f:new g(k*j),i=i&&i.length===f.length?i:new g(k*j),f.set(i),b=0;j>b;b++)l[b]=h.getChannelData(b);for(c.process(f,c.channelCount),b=0;k>b;b++)for(d=0;j>d;d++)l[d][b]=f[b*c.channelCount+d]}var c=this,d=function(){return this}(),f=null,h=null,i=null;c.start.apply(c,arguments),importScripts(),d.onprocessmedia=a,d.onaudioprocess=b,c._mspBufferFill=a,c._waBufferFill=b},{ready:!1,initMSP:function(a){this.channelCount=a.audioChannels,this.sampleRate=a.audioSampleRate,this.bufferSize=a.audioLength*this.channelCount,this.ready=!0,this.emit("ready",[])},initWA:function(a){var b=a.outputBuffer;this.channelCount=b.numberOfChannels,this.sampleRate=b.sampleRate,this.bufferSize=b.length*this.channelCount,this.ready=!0,this.emit("ready",[])}})}(this.Sink),function(a){!function(){function b(c,d){return c&&d?b[c]=d:c&&b[c]instanceof Function&&(a.interpolate=b[c]),b[c]}a.interpolation=b,b("linear",function(a,b){var d=c.floor(b),e=d+1,f=b-d;return e=e<a.length?e:0,a[d]*(1-f)+a[e]*f}),b("nearest",function(a,b){return b>=a.length-.5?a[0]:a[c.round(b)]}),b("linear")}(),a.resample=function(b,d,e,f,h){var i,j,k=arguments.length,l=2===k?d:3===k?d/e:f/d*h/e,m=b.length,n=c.ceil(m/l),o=new g(n);for(i=0,j=0;m>i;i+=l)o[j++]=a.interpolate(b,i);return o}}(this.Sink),function(a){a.deinterleave=function(a,b){var c,d,e=a.length,f=e/b,h=[];for(c=0;b>c;c++)for(h[c]=new g(f),d=0;f>d;d++)h[c][d]=a[d*b+c];return h},a.interleave=function(a,b,c){b=b||a.length;var d,e,f=a[0].length,h=a.length;for(c=c||new g(f*b),d=0;h>d;d++)for(e=0;f>e;e++)c[d+e*b]=a[d][e];return c},a.mix=function(a){var b,d,e,f=[].slice.call(arguments,1);for(e=0;e<f.length;e++)for(b=c.max(a.length,f[e].length),d=0;b>d;d++)a[d]+=f[e][d];return a},a.resetBuffer=function(a){var b,c=a.length;for(b=0;c>b;b++)a[b]=0;return a},a.clone=function(a,b){var c,d=a.length;for(b=b||new g(d),c=0;d>c;c++)b[c]=a[c];return b},a.createDeinterleaved=function(a,b){var c,d=new e(b);for(c=0;b>c;c++)d[c]=new g(a);return d},a.memcpy=function(a,b,c,d,e){if(a=a.subarray||a.slice?a:a.buffer,c=c.subarray||c.slice?c:c.buffer,a=b?a.subarray?a.subarray(b,e&&b+e):a.slice(b,e&&b+e):a,c.set)c.set(a,d);else for(var f=0;f<a.length;f++)c[f+d]=a[f];return c},a.memslice=function(a,b,c){return a.subarray?a.subarray(b,c):a.slice(b,c)},a.mempad=function(b,c,d){return c=c.length?c:new b.constructor(c),a.memcpy(b,0,c,d),c},a.linspace=function(a,b,c){var d,f,g,h;for(c=c.length?(d=c.length)&&c:e(d=c),h=(b-a)/--d,g=a+h,f=1;d>f;f++,g+=h)c[f]=g;return c[0]=a,c[d]=b,c},a.ftoi=function(a,b,d){var e,f=c.pow(2,b-1);for(d=d||new a.constructor(a.length),e=0;e<a.length;e++)d[e]=~~(f*a[e]);return d}}(this.Sink),function(a){function b(b,c){a.EventEmitter.call(this),this.bufferSize=isNaN(b)||null===b?this.bufferSize:b,this.channelCount=isNaN(c)||null===c?this.channelCount:c;var d=this;this.callback=function(){return d.process.apply(d,arguments)},this.resetBuffer()}b.prototype={buffer:null,zeroBuffer:null,parentSink:null,bufferSize:4096,channelCount:2,offset:null,resetBuffer:function(){this.buffer=new g(this.bufferSize),this.zeroBuffer=new g(this.bufferSize)},process:function(a){null===this.offset&&this.loadBuffer();for(var b=0;b<a.length;b++)this.offset>=this.buffer.length&&this.loadBuffer(),a[b]=this.buffer[this.offset++]},loadBuffer:function(){this.offset=0,a.memcpy(this.zeroBuffer,0,this.buffer,0),this.emit("audioprocess",[this.buffer,this.channelCount])}},a.Proxy=b,a.prototype.createProxy=function(b){var c=new a.Proxy(b,this.channelCount);return c.parentSink=this,this.on("audioprocess",c.callback),c}}(this.Sink),void function(a){function b(){this.ringBuffer&&("interleaved"===this.channelMode?this.ringSpin:this.ringSpinInterleaved).apply(this,arguments)}a.on("init",function(a){a.on("preprocess",b)}),a.prototype.ringBuffer=null,a.prototype.ringSpin=function(a){var b,c=this.ringBuffer,d=a.length,e=c.length,f=this.ringOffset;for(b=0;d>b;b++)a[b]+=c[f],f=(f+1)%e;this.ringOffset=f},a.prototype.ringSpinDeinterleaved=function(a){var b,c,d=this.ringBuffer,e=a.length,f=d.length,g=d[0].length,h=this.ringOffset;for(b=0;e>b;b+=f){for(c=0;f>c;c++)a[b+c]+=d[c][h];h=(h+1)%g}this.ringOffset=c}}(this.Sink),void function(a,b){b=a.prototype,a.on("init",function(a){a.asyncBuffers=[],a.syncBuffers=[],a.on("preprocess",a.writeBuffersSync),a.on("postprocess",a.writeBuffersAsync)}),b.writeMode="async",b.asyncBuffers=b.syncBuffers=null,b.writeBuffersAsync=function(a){var b,d,e,f,g,h=this.asyncBuffers,i=a.length;if(h)for(e=0;e<h.length;e++){for(b=h[e],d=b.b.length,g=b.d,b.d-=c.min(g,i),f=0;i>f+g&&d>f;f++)a[f+g]+=b.b[f];b.b=b.b.subarray(f+g),e>=d&&h.splice(e--,1)}},b.writeBuffersSync=function(a){for(var b=this.syncBuffers,c=a.length,d=0,e=0;c>d&&b.length;d++)a[d]+=b[0][e],b[0].length<=e?(b.splice(0,1),e=0):e++;b.length&&(b[0]=b[0].subarray(e))},b.writeBufferAsync=function(b,c){b="deinterleaved"===this.mode?a.interleave(b,this.channelCount):b;var d=this.asyncBuffers;return d.push({b:b,d:isNaN(c)?~~((+new Date-this.previousHit)/1e3*this.sampleRate):c}),d.length},b.writeBufferSync=function(b){b="deinterleaved"===this.mode?a.interleave(b,this.channelCount):b;var c=this.syncBuffers;return c.push(b),c.length},b.writeBuffer=function(){return this["async"===this.writeMode?"writeBufferAsync":"writeBufferSync"].apply(this,arguments)},b.getSyncWriteOffset=function(){var a,b=this.syncBuffers,c=0;for(a=0;a<b.length;a++)c+=b[a].length;return c}}(this.Sink),void function(a){function b(a){this.boundTo=a,this.buffers=[],a.activeRecordings.push(this)}a.on("init",function(a){a.activeRecordings=[],a.on("postprocess",a.recordData)}),a.prototype.activeRecordings=null,a.prototype.record=function(){var b=new a.Recording(this);return this.emit("record",[b]),b},a.prototype.recordData=function(a){var b,c=this.activeRecordings,d=c.length;for(b=0;d>b;b++)c[b].add(a)},b.prototype={add:function(a){this.buffers.push(a)},clear:function(){this.buffers=[]},stop:function(){var a,b=this.boundTo.activeRecordings;for(a=0;a<b.length;a++)b[a]===this&&b.splice(a--,1)},join:function(){var a,b,c,d=0,e=0,f=this.buffers,h=f.length;for(c=0;h>c;c++)d+=f[c].length;for(a=new g(d),c=0;h>c;c++){for(b=0;b<f[c].length;b++)a[e+b]=f[c][b];e+=f[c].length}return a}},a.Recording=b}(this.Sink),L.prototype={sampleRate:44100,attack:.01,release:.01,sample:0,pushSample:function(a){return this.sample=c.abs((a>this.sample?this.attack:this.release)*(this.sample-a)+a),this.sample},getMix:function(){return this.sample}};var Q=function(){"use strict";function a(a,b,c,d,e,f){for(var g=e.twiddle,h=0;f>h;h++){var i=a[2*(b+c*h)],j=a[2*(b+c*h)+1],k=a[2*(b+c*(h+f))],l=a[2*(b+c*(h+f))+1],m=g[2*(0+d*h)],n=g[2*(0+d*h)+1],o=k*m-l*n,p=k*n+l*m,q=i+o,r=j+p,s=i-o,t=j-p;a[2*(b+c*h)]=q,a[2*(b+c*h)+1]=r,a[2*(b+c*(h+f))]=s,a[2*(b+c*(h+f))+1]=t}}function b(a,b,c,d,e,f){for(var g=e.twiddle,h=f,i=2*f,j=d,k=2*d,l=g[2*(0+d*f)+1],m=0;f>m;m++){var n=a[2*(b+c*m)],o=a[2*(b+c*m)+1],p=a[2*(b+c*(m+h))],q=a[2*(b+c*(m+h))+1],r=g[2*(0+j*m)],s=g[2*(0+j*m)+1],t=p*r-q*s,u=p*s+q*r,v=a[2*(b+c*(m+i))],w=a[2*(b+c*(m+i))+1],x=g[2*(0+k*m)],y=g[2*(0+k*m)+1],z=v*x-w*y,A=v*y+w*x,B=t+z,C=u+A,D=n+B,E=o+C;a[2*(b+c*m)]=D,a[2*(b+c*m)+1]=E;var F=n-.5*B,G=o-.5*C,H=(t-z)*l,I=(u-A)*l,J=F-I,K=G+H;a[2*(b+c*(m+h))]=J,a[2*(b+c*(m+h))+1]=K;var L=F+I,M=G-H;a[2*(b+c*(m+i))]=L,a[2*(b+c*(m+i))+1]=M}}function d(a,b,c,d,e,f){for(var g,h,i,j,k=e.twiddle,l=f,m=2*f,n=3*f,o=d,p=2*d,q=3*d,r=0;f>r;r++){var s=a[2*(b+c*r)],t=a[2*(b+c*r)+1],u=a[2*(b+c*(r+l))],v=a[2*(b+c*(r+l))+1],w=k[2*(0+o*r)],x=k[2*(0+o*r)+1],y=u*w-v*x,z=u*x+v*w,A=a[2*(b+c*(r+m))],B=a[2*(b+c*(r+m))+1],C=k[2*(0+p*r)],D=k[2*(0+p*r)+1],E=A*C-B*D,F=A*D+B*C,G=a[2*(b+c*(r+n))],H=a[2*(b+c*(r+n))+1],I=k[2*(0+q*r)],J=k[2*(0+q*r)+1],K=G*I-H*J,L=G*J+H*I,M=s+E,N=t+F,O=s-E,P=t-F,Q=y+K,R=z+L,S=y-K,T=z-L,U=M+Q,V=N+R;e.inverse?(g=O-T,h=P+S):(g=O+T,h=P-S);var W=M-Q,X=N-R;e.inverse?(i=O+T,j=P-S):(i=O-T,j=P+S),a[2*(b+c*r)]=U,a[2*(b+c*r)+1]=V,a[2*(b+c*(r+l))]=g,a[2*(b+c*(r+l))+1]=h,a[2*(b+c*(r+m))]=W,a[2*(b+c*(r+m))+1]=X,a[2*(b+c*(r+n))]=i,a[2*(b+c*(r+n))+1]=j}}function e(a,b,c,d,e,f,g){for(var h,i,j,k,l=e.twiddle,m=e.n,n=new Float64Array(2*g),o=0;f>o;o++){for(h=0,k=o;g>h;h++,k+=f)i=a[2*(b+c*k)],j=a[2*(b+c*k)+1],n[2*h]=i,n[2*h+1]=j;for(h=0,k=o;g>h;h++,k+=f){var p=0;i=n[0],j=n[1],a[2*(b+c*k)]=i,a[2*(b+c*k)+1]=j;for(var q=1;g>q;q++){p=(p+d*k)%m;var r=a[2*(b+c*k)],s=a[2*(b+c*k)+1],t=n[2*q],u=n[2*q+1],v=l[2*p],w=l[2*p+1],x=t*v-u*w,y=t*w+u*v,z=r+x,A=s+y;a[2*(b+c*k)]=z,a[2*(b+c*k)+1]=A}}}}function f(c,g,h,i,j,k,l,m,n){var o,p,q,r=m.shift(),s=m.shift();if(1==s)for(o=0;r*s>o;o++)p=i[2*(j+k*l*o)],q=i[2*(j+k*l*o)+1],c[2*(g+h*o)]=p,c[2*(g+h*o)+1]=q;else for(o=0;r>o;o++)f(c,g+h*o*s,h,i,j+o*k*l,k*r,l,m.slice(),n);switch(r){case 2:a(c,g,h,k,n,s);break;case 3:b(c,g,h,k,n,s);break;case 4:d(c,g,h,k,n,s);break;default:e(c,g,h,k,n,s,r)}}function g(a,b,c){var d=[].slice.call(arguments);d[0]=this.sampleRate=isNaN(a)||null===a?this.sampleRate:a,d[1]=this.bufferSize=isNaN(b)||null===b?this.bufferSize:b,d[2]=!!c,this.__super.apply(this,d.slice(1))}var h=function(a,b){if(arguments.length<2)throw new RangeError("You didn't pass enough arguments, passed `"+arguments.length+"'");if(a=~~a,b=!!b,1>a)throw new RangeError("n is outside range, should be positive integer, was `"+a+"'");this.inputBuffer=new Float64Array(2*a),this.outputBuffer=new Float64Array(2*a);var d,e,f={n:a,inverse:b,factors:[],twiddle:new Float64Array(2*a),scratch:new Float64Array(2*a)},g=f.twiddle,h=2*c.PI/a;for(d=0;a>d;d++)e=b?h*d:-h*d,g[2*d]=c.cos(e),g[2*d+1]=c.sin(e);for(var i=4,j=c.floor(c.sqrt(a));a>1;){for(;a%i;){switch(i){case 4:i=2;break;case 2:i=3;break;default:i+=2}i>j&&(i=a)}a/=i,f.factors.push(i),f.factors.push(a)}this.state=f,this.resetFT()};return h.prototype.process=function(a,b,c){this.process_explicit(a||this.outputBuffer,0,1,b||this.inputBuffer,0,1,c)},h.prototype.process_explicit=function(a,b,c,d,e,g,h){var i,j,k;c=~~c,g=~~g,h=h||this.inputType;var l="real"===h?h:"complex";if(1>c)throw new RangeError("outputStride is outside range, should be positive integer, was `"+c+"'");if(1>g)throw new RangeError("inputStride is outside range, should be positive integer, was `"+g+"'");if("real"==l){for(i=0;i<this.state.n;i++)j=d[e+g*i],k=0,this.state.scratch[2*i]=j,this.state.scratch[2*i+1]=k;f(a,b,c,this.state.scratch,0,1,1,this.state.factors.slice(),this.state)}else if(d==a)for(f(this.state.scratch,0,1,d,e,1,g,this.state.factors.slice(),this.state),i=0;i<this.state.n;i++)j=this.state.scratch[2*i],k=this.state.scratch[2*i+1],a[2*(b+c*i)]=j,a[2*(b+c*i)+1]=k;else f(a,b,c,d,e,1,g,this.state.factors.slice(),this.state)},h.prototype.__super=h,g.prototype=h.prototype,g.prototype.inputType="real",g.prototype.sampleRate=44100,g.prototype.bufferSize=4096,g.prototype.resetFT=function(){this.inputBuffer=new Float64Array(2*this.bufferSize),this.outputBuffer=new Float64Array(2*this.bufferSize),this.spectrum=new Float64Array(this.bufferSize/2),this.bandWidth=this.sampleRate/this.bufferSize/2,this.peakBand=0,this.peak=0,this.sample=0,this.offset=0,this.maxOffset="real"===this.inputType?this.bufferSize:2*this.bufferSize,this.pushSample=this._pushSample},g.prototype.pushSample=function(a){return this.resetFT(),this.pushSample(a)},g.prototype._pushSample=function(a){return this.inputBuffer[this.offset]=a,this.sample=a,this.offset=(this.offset+1)%this.maxOffset,this.offset||this.process(),a},g.prototype.getMix=function(){return this.sample},g.prototype.getBandFrequency=function(a){return this.bandWidth*a+.5*this.bandWidth},g.prototype.calculateSpectrum=function(){var a,b,d,e,f,g=(this.spectrum,this.outputBuffer),h=2/this.bufferSize,i=this.bufferSize/2;for(a=0,b=2;i>a;a++,b+=2)d=g[b+0],e=g[b+1],f=h*c.sqrt(d*d+e*e),f>this.peak&&(this.peakBand=a,this.peak=f),this.spectrum[a]=f},g.prototype._process=g.prototype.process,g.prototype.process=function(){this._process.apply(this,arguments),this.calculateSpectrum()},g}();for(N.ADSREnvelope=s,N.StepSequencer=t,N.UIControl=u,N.BiquadFilter=v,N.BitCrusher=w,N.Chorus=x,N.CombFilter=y,N.Compressor=z,N.Convolution=A,N.Delay=B,N.Distortion=C,N.GainController=E,N.IIRFilter=F,N.LP12Filter=H,N.Limiter=G,N.Reverb=D,N.Noise=I,N.Oscillator=J,N.Sampler=K,N.Amplitude=L,N.FFT=Q,N.AudioDevice=N.Sink=function(){return this}().Sink,N.Automation=m,N.BufferEffect=n,N.EffectClass=p,N.GeneratorClass=q,N.codecs=N.Codec=o,N.plugins=r;f.list.length;)f.list.shift().call(N);return f=null,void function(a,b){function c(a,b,d,e){var f,g;if(b){d=d||b.prototype,f=b.prototype=new p,f.name=f.fxid=a,c[a]=k(a,b,e);for(g in d)d.hasOwnProperty(g)&&(f[g]=d[g]);for(g in p)"prototype"!==g&&p.hasOwnProperty(g)&&(c[a][g]=p[g])}return c[a]}for(N.effects=c,b=0;b<a.length;b++)N[a[b]]=c(a[b],N[a[b]],N[a[b]].prototype);c("BiquadAllPassFilter",v.AllPass),c("BiquadBandPassFilter",v.BandPass),c("BiquadHighPassFilter",v.HighPass),c("BiquadLowPassFilter",v.LowPass),c("FreeverbAllPassFilter",D.AllPassFilter)}(["BiquadFilter","BitCrusher","Chorus","CombFilter","Compressor","Convolution","Delay","Distortion","GainController","IIRFilter","LP12Filter","Limiter","Reverb","Amplitude","FFT"]),void function(a,b){function c(a,b,d,e){var f,g;if(b){d=d||b.prototype,f=b.prototype=new q,f.name=f.fxid=a,c[a]=k(a,b,e);for(g in d)d.hasOwnProperty(g)&&(f[g]=d[g]);for(g in q)"prototype"!==g&&q.hasOwnProperty(g)&&(c[a][g]=q[g])}return c[a]}for(N.generators=c,b=0;b<a.length;b++)N[a[b]]=c(a[b],N[a[b]],N[a[b]].prototype)}(["Noise","Oscillator","Sampler","ADSREnvelope","StepSequencer","UIControl"]),o("wav",N.PCMData),N.version="0.6.6",N}.call("undefined"==typeof exports?{}:this,this.window||global,Math,Object,Array);